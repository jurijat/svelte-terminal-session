<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Terminal Session Web Component Demo</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      color: white;
      text-align: center;
      margin-bottom: 40px;
    }

    .demo-section {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }

    .demo-section h2 {
      margin-top: 0;
      color: #333;
    }

    terminal-session {
      height: 400px;
      margin: 20px 0;
    }

    .controls {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background: #667eea;
      color: white;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.3s;
    }

    button:hover {
      background: #5a64d8;
    }

    .code-example {
      background: #f6f8fa;
      border: 1px solid #d1d5da;
      border-radius: 6px;
      padding: 15px;
      margin: 20px 0;
      font-family: 'Monaco', 'Consolas', monospace;
      font-size: 13px;
      overflow-x: auto;
    }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .feature {
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }

    .feature h3 {
      margin-top: 0;
      color: #667eea;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üñ•Ô∏è Terminal Session Web Component Demo</h1>

    <div class="demo-section">
      <h2>Basic Example</h2>
      <p>A simple terminal showing a git workflow session:</p>
      <terminal-session id="basic-terminal"></terminal-session>
    </div>

    <div class="demo-section">
      <h2>Light Theme Example</h2>
      <p>Same session with light theme:</p>
      <terminal-session id="light-terminal" theme="light"></terminal-session>
    </div>

    <div class="demo-section">
      <h2>Custom Colors Example</h2>
      <p>Terminal with custom color scheme:</p>
      <terminal-session id="custom-terminal"></terminal-session>
    </div>

    <div class="demo-section">
      <h2>Interactive Controls</h2>
      <div class="controls">
        <button onclick="addCustomSession()">Load Custom Session</button>
        <button onclick="toggleTheme()">Toggle Theme</button>
        <button onclick="changeSpeed()">Change Speed</button>
        <button onclick="showErrorExample()">Show Error Example</button>
      </div>
      <terminal-session id="interactive-terminal" autoplay="false"></terminal-session>
    </div>

    <div class="demo-section">
      <h2>Features</h2>
      <div class="features">
        <div class="feature">
          <h3>üé® Themeable</h3>
          <p>Light/dark themes with custom color overrides</p>
        </div>
        <div class="feature">
          <h3>‚ñ∂Ô∏è Playback Control</h3>
          <p>Play, pause, and reset session recordings</p>
        </div>
        <div class="feature">
          <h3>üéØ Step Types</h3>
          <p>Command, output, error, warning, info, success</p>
        </div>
        <div class="feature">
          <h3>‚ö° Performant</h3>
          <p>Built with Svelte 5 for optimal performance</p>
        </div>
        <div class="feature">
          <h3>üì¶ Web Component</h3>
          <p>Works with any framework or vanilla JS</p>
        </div>
        <div class="feature">
          <h3>üîß Customizable</h3>
          <p>Configurable speed, colors, and behavior</p>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h2>Usage Example</h2>
      <div class="code-example">
&lt;terminal-session
  theme="dark"
  autoplay="true"
  playback-speed="1.5"
  title="My Terminal"
&gt;&lt;/terminal-session&gt;

&lt;script&gt;
  const terminal = document.querySelector('terminal-session');
  terminal.session = [
    { type: 'command', content: 'npm install', delay: 500 },
    { type: 'output', content: 'Installing dependencies...', delay: 1000 },
    { type: 'success', content: 'Dependencies installed successfully!', delay: 500 }
  ];
&lt;/script&gt;
      </div>
    </div>
  </div>

  <script type="module">
    import './src/lib/Terminal.svelte';

    // Basic terminal session
    const basicSession = [
      { type: 'command', content: 'git status', delay: 500 },
      { type: 'output', content: 'On branch main\nYour branch is up to date with \'origin/main\'.\n\nChanges not staged for commit:', delay: 800 },
      { type: 'warning', content: '  modified:   src/components/Header.jsx\n  modified:   src/styles/main.css', delay: 600 },
      { type: 'command', content: 'git add .', delay: 1000 },
      { type: 'command', content: 'git commit -m "Update header styling"', delay: 800 },
      { type: 'output', content: '[main 3a4f5b6] Update header styling', delay: 500 },
      { type: 'success', content: ' 2 files changed, 24 insertions(+), 8 deletions(-)', delay: 400 },
      { type: 'command', content: 'git push origin main', delay: 1000 },
      { type: 'output', content: 'Enumerating objects: 7, done.\nCounting objects: 100% (7/7), done.\nDelta compression using up to 8 threads\nCompressing objects: 100% (4/4), done.\nWriting objects: 100% (4/4), 512 bytes | 512.00 KiB/s, done.', delay: 1200 },
      { type: 'success', content: 'To github.com:user/repo.git\n   2b3c4d5..3a4f5b6  main -> main', delay: 500 }
    ];

    // Set sessions but don't autoplay all at once to prevent performance issues
    document.getElementById('basic-terminal').session = basicSession;
    document.getElementById('basic-terminal').autoplay = false;

    document.getElementById('light-terminal').session = basicSession;
    document.getElementById('light-terminal').autoplay = false;

    // Custom colors terminal
    const customTerminal = document.getElementById('custom-terminal');
    customTerminal.session = basicSession;
    customTerminal.colors = {
      background: '#1e1e2e',
      foreground: '#cdd6f4',
      prompt: '#89b4fa',
      command: '#94e2d5',
      success: '#a6e3a1',
      warning: '#f9e2af',
      error: '#f38ba8'
    };
    customTerminal.autoplay = false;
    
    // Only autoplay the first visible terminal to prevent performance issues
    // Use Intersection Observer to play terminals when they come into view
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const terminal = entry.target;
          if (terminal.session && terminal.session.length > 0 && !terminal.hasPlayed) {
            terminal.hasPlayed = true;
            terminal.autoplay = true;
          }
        }
      });
    }, { threshold: 0.5 });

    // Observe all terminals except the interactive one
    observer.observe(document.getElementById('basic-terminal'));
    observer.observe(document.getElementById('light-terminal'));
    observer.observe(document.getElementById('custom-terminal'));

    // Interactive terminal
    const interactiveTerminal = document.getElementById('interactive-terminal');
    interactiveTerminal.session = [
      { type: 'info', content: 'Welcome to the interactive terminal demo!', delay: 500 },
      { type: 'command', content: 'echo "Hello, World!"', delay: 800 },
      { type: 'output', content: 'Hello, World!', delay: 500 }
    ];

    // Interactive functions
    window.addCustomSession = function() {
      interactiveTerminal.session = [
        { type: 'command', content: 'npm run build', delay: 500 },
        { type: 'output', content: '> svelte-terminal@1.0.0 build\n> vite build', delay: 800 },
        { type: 'info', content: 'vite v5.0.0 building for production...', delay: 600 },
        { type: 'output', content: '‚úì 42 modules transformed.', delay: 1000 },
        { type: 'success', content: 'dist/index.html        0.45 kB\ndist/assets/index.css  1.23 kB\ndist/assets/index.js   8.76 kB', delay: 800 },
        { type: 'success', content: '‚úì built in 1.23s', delay: 500 }
      ];
      interactiveTerminal.autoplay = true;
    };

    window.toggleTheme = function() {
      const current = interactiveTerminal.theme;
      interactiveTerminal.theme = current === 'dark' ? 'light' : 'dark';
    };

    window.changeSpeed = function() {
      const speeds = [0.5, 1, 1.5, 2];
      const current = interactiveTerminal.playbackSpeed || 1;
      const currentIndex = speeds.indexOf(current);
      const nextIndex = (currentIndex + 1) % speeds.length;
      interactiveTerminal.playbackSpeed = speeds[nextIndex];
      alert(`Playback speed set to ${speeds[nextIndex]}x`);
    };

    window.showErrorExample = function() {
      interactiveTerminal.session = [
        { type: 'command', content: 'npm test', delay: 500 },
        { type: 'output', content: '> svelte-terminal@1.0.0 test\n> vitest', delay: 800 },
        { type: 'error', content: 'FAIL  src/components/Terminal.test.js', delay: 600 },
        { type: 'error', content: '  ‚óè Terminal ‚Ä∫ should render without errors\n\n    TypeError: Cannot read property \'theme\' of undefined', delay: 800 },
        { type: 'output', content: '\nTest Suites: 1 failed, 1 total\nTests:       1 failed, 1 total', delay: 600 },
        { type: 'error', content: 'npm ERR! Test failed. See above for more details.', delay: 500 }
      ];
      interactiveTerminal.autoplay = true;
    };
  </script>
</body>
</html>