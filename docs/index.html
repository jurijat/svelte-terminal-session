<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Terminal Session Web Component Demo</title>
    <style>
      body {
        font-family: system-ui, -apple-system, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      h1 {
        color: white;
        text-align: center;
        margin-bottom: 40px;
      }

      .demo-section {
        background: white;
        border-radius: 12px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      }

      .demo-section h2 {
        margin-top: 0;
        color: #333;
      }

      terminal-session {
        height: 400px;
        margin: 20px 0;
      }

      .controls {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      button {
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        background: #667eea;
        color: white;
        cursor: pointer;
        font-size: 14px;
        transition: background 0.3s;
      }

      button:hover {
        background: #5a64d8;
      }

      .code-example {
        background: #f6f8fa;
        border: 1px solid #d1d5da;
        border-radius: 6px;
        padding: 15px;
        margin: 20px 0;
        font-family: "Monaco", "Consolas", monospace;
        font-size: 13px;
        overflow-x: auto;
      }

      .features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 20px 0;
      }

      .feature {
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #667eea;
      }

      .feature h3 {
        margin-top: 0;
        color: #667eea;
      }

      .github-link {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.95);
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        text-decoration: none;
        color: #333;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s;
        z-index: 1000;
      }

      .github-link:hover {
        background: white;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        transform: translateY(-2px);
      }

      .github-link svg {
        width: 24px;
        height: 24px;
      }

      @media (max-width: 768px) {
        .github-link {
          position: static;
          margin: 0 auto 20px;
          display: inline-flex;
        }

        .container {
          text-align: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <a
        href="https://github.com/jurijat/svelte-terminal-session"
        target="_blank"
        class="github-link"
      >
        <svg viewBox="0 0 16 16" fill="currentColor">
          <path
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"
          />
        </svg>
        View on GitHub
      </a>
      <h1>üñ•Ô∏è Terminal Session Web Component Demo</h1>

      <div class="demo-section">
        <h2>Basic Example</h2>
        <p>A simple terminal showing a git workflow session:</p>
        <terminal-session
          id="basic-terminal"
          show-theme-toggle="true"
        ></terminal-session>
      </div>

      <div class="demo-section">
        <h2>Light Theme Example</h2>
        <p>Same session with light theme:</p>
        <terminal-session
          id="light-terminal"
          theme="light"
          show-theme-toggle="true"
        ></terminal-session>
      </div>

      <div class="demo-section">
        <h2>Custom Colors Example</h2>
        <p>Terminal with custom color scheme:</p>
        <terminal-session
          id="custom-terminal"
          show-theme-toggle="true"
        ></terminal-session>
      </div>

      <div class="demo-section">
        <h2>Customizable Toolbar & Header</h2>
        <p>Fine-grained control over all UI elements:</p>
        <div class="features">
          <div class="feature">
            <h3>No Window Buttons</h3>
            <terminal-session
              id="toolbar-no-window"
              title="No Window Controls"
              show-window-buttons="false"
              playback-speed="2"
            ></terminal-session>
          </div>
          <div class="feature">
            <h3>No Control Buttons</h3>
            <terminal-session
              id="toolbar-no-controls"
              title="Clean Header"
              show-play-button="false"
              show-reset-button="false"
              show-theme-toggle="false"
              show-window-buttons="false"
            ></terminal-session>
          </div>
          <div class="feature">
            <h3>Play Button Only</h3>
            <terminal-session
              id="toolbar-play-only"
              title="Minimal Controls"
              show-reset-button="false"
              show-theme-toggle="false"
              show-window-buttons="false"
            ></terminal-session>
          </div>
          <div class="feature">
            <h3>No Header At All</h3>
            <terminal-session
              id="toolbar-no-header"
              show-header="false"
            ></terminal-session>
          </div>
        </div>
      </div>

      <div class="demo-section">
        <h2>üß™ Test Tab Closing & Theme Toggle Features</h2>
        <p>
          <strong
            >Test the new tab closing and theme toggle functionality:</strong
          >
        </p>

        <div
          style="
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #28a745;
          "
        >
          <h4 style="margin-top: 0; color: #28a745">
            üîÑ Tab Closing Test Instructions:
          </h4>
          <ol style="margin-bottom: 0">
            <li>
              <strong>Switch between tabs</strong> to see different content
              (Frontend, API, Tests, etc.)
            </li>
            <li>
              <strong>Close the active tab</strong> by clicking the √ó button -
              content should immediately switch to the next tab
            </li>
            <li>
              <strong>Try closing different tabs</strong> - each has unique
              content so you can verify the switch works
            </li>
            <li>
              <strong>Close multiple tabs</strong> to test the behavior with
              fewer tabs remaining
            </li>
          </ol>
        </div>

        <div
          style="
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #007bff;
          "
        >
          <h4 style="margin-top: 0; color: #007bff">
            üé® Theme Toggle Test Instructions:
          </h4>
          <ol style="margin-bottom: 0">
            <li>
              <strong>Look for the theme toggle button</strong> (‚òÄ/üåô) in the
              terminal header
            </li>
            <li>
              <strong>Click the theme button</strong> - theme should change
              immediately
            </li>
            <li>
              <strong>Toggle multiple times</strong> to verify smooth switching
              between light/dark themes
            </li>
          </ol>
        </div>

        <terminal-session
          id="tabbed-terminal"
          show-tabs="true"
          allow-tab-close="true"
          tab-bar-position="top"
          playback-speed="1.5"
          show-theme-toggle="true"
        ></terminal-session>

        <p style="color: #666; font-size: 14px; margin-top: 10px">
          ‚úÖ <strong>Expected Behavior:</strong><br />
          ‚Ä¢ Tab closing: Content switches immediately to next tab, no stale
          content<br />
          ‚Ä¢ Theme toggle: Instant theme change with button icon updating<br />
          ‚Ä¢ Background processing: Tabs continue running when you switch between
          them
        </p>
      </div>

      <div class="demo-section">
        <h2>Minimal Tabbed Terminal</h2>
        <p>
          Tabs below header without any control buttons for a clean interface:
        </p>
        <terminal-session
          id="tabbed-minimal"
          show-tabs="true"
          show-play-button="false"
          show-reset-button="false"
          show-theme-toggle="false"
          show-window-buttons="false"
          allow-tab-close="true"
          tab-bar-position="top"
        ></terminal-session>
      </div>

      <div class="demo-section">
        <h2>Completely Minimal - No Toolbar</h2>
        <p>Terminal without any header or controls, just the content:</p>
        <terminal-session
          id="minimal-no-toolbar"
          show-header="false"
          theme="dark"
          autoplay="true"
        ></terminal-session>
        <p style="color: #666; font-size: 14px; margin-top: 10px">
          üí° Perfect for embedding in documentation or tutorials
        </p>
      </div>

      <div class="demo-section">
        <h2>Rich Text Colorization</h2>
        <p>
          Terminal with colorized output similar to real terminal applications:
        </p>
        <terminal-session
          id="rich-content-terminal"
          autoplay="true"
        ></terminal-session>
      </div>

      <div class="demo-section">
        <h2>Interactive Controls</h2>
        <div class="controls">
          <button onclick="addCustomSession()">Load Custom Session</button>
          <button onclick="toggleTheme()">Toggle Theme</button>
          <button onclick="changeSpeed()">Change Speed</button>
          <button onclick="showErrorExample()">Show Error Example</button>
          <button onclick="showRichContentExample()">Show Rich Content</button>
          <button onclick="showTableExample()">Show Table Layout</button>
          <button onclick="testTabClosing()" style="background: #28a745">
            üß™ Test Tab Closing
          </button>
          <button onclick="testThemeToggle()" style="background: #007bff">
            üé® Test Theme Toggle
          </button>
        </div>
        <terminal-session
          id="interactive-terminal"
          autoplay="false"
          show-theme-toggle="true"
        ></terminal-session>
      </div>

      <div class="demo-section">
        <h2>Features</h2>
        <div class="features">
          <div class="feature">
            <h3>üé® Themeable</h3>
            <p>Light/dark themes with custom color overrides</p>
          </div>
          <div class="feature">
            <h3>‚ñ∂Ô∏è Playback Control</h3>
            <p>Play, pause, and reset session recordings</p>
          </div>
          <div class="feature">
            <h3>üéØ Step Types</h3>
            <p>Command, output, error, warning, info, success</p>
          </div>
          <div class="feature">
            <h3>‚ö° Performant</h3>
            <p>Built with Svelte 5 for optimal performance</p>
          </div>
          <div class="feature">
            <h3>üì¶ Web Component</h3>
            <p>Works with any framework or vanilla JS</p>
          </div>
          <div class="feature">
            <h3>üîß Customizable</h3>
            <p>Configurable speed, colors, and behavior</p>
          </div>
          <div class="feature">
            <h3>üéõÔ∏è Full UI Control</h3>
            <p>
              Show/hide header, window buttons, and control buttons individually
            </p>
          </div>
          <div class="feature">
            <h3>‚å®Ô∏è Typing Effect</h3>
            <p>Realistic typing animation with variable speed</p>
          </div>
          <div class="feature">
            <h3>üìë Advanced Tabs</h3>
            <p>Background processing, closable tabs, top/bottom position</p>
          </div>
          <div class="feature">
            <h3>üëÅÔ∏è Smart Autoplay</h3>
            <p>Autoplay on visibility, tab switch, or manual trigger</p>
          </div>
          <div class="feature">
            <h3>üîÑ State Persistence</h3>
            <p>Tabs maintain state when switching</p>
          </div>
          <div class="feature">
            <h3>üéØ Web Component</h3>
            <p>HTML attributes with proper type conversion</p>
          </div>
        </div>
      </div>

      <div class="demo-section">
        <h2>Usage Examples</h2>
        <div class="code-example">
          &lt;!-- Basic terminal with custom controls --&gt;
          &lt;terminal-session theme="dark" autoplay="true" playback-speed="1.5"
          title="My Terminal" show-window-buttons="false"
          show-reset-button="false" &gt;&lt;/terminal-session&gt; &lt;!--
          Minimal terminal without header --&gt; &lt;terminal-session
          show-header="false" autoplay="true" &gt;&lt;/terminal-session&gt;
          &lt;!-- Tabbed terminal with bottom tabs --&gt; &lt;terminal-session
          show-tabs="true" tab-bar-position="bottom" allow-tab-close="true"
          &gt;&lt;/terminal-session&gt; &lt;script&gt; const terminal =
          document.querySelector('terminal-session'); // Set a simple session
          terminal.session = [ { type: 'command', content: 'npm install', delay:
          500 }, { type: 'output', content: 'Installing...', delay: 1000 }, {
          type: 'success', content: 'Done!', delay: 500 } ]; // Or set tabs for
          multiple sessions terminal.tabs = [ { id: 'tab1', title: 'Server',
          icon: 'üñ•Ô∏è', session: serverSession, closable: true }, { id: 'tab2',
          title: 'Tests', icon: 'üß™', session: testSession } ]; &lt;/script&gt;
        </div>
      </div>
    </div>

    <script type="module">
      // Debug information for GitHub Pages deployment
      console.log("üîç Debug Info:");
      console.log("Current URL:", window.location.href);
      console.log(
        "Base URL:",
        window.location.origin + window.location.pathname
      );

      // Try ES module first, fallback to UMD if it fails
      try {
        console.log("üì¶ Attempting to load ES module...");
        await import("./dist/terminal-session.es.js");
        console.log("‚úÖ ES module loaded successfully");
      } catch (error) {
        console.warn(
          "‚ö†Ô∏è ES module failed, loading UMD fallback:",
          error.message
        );

        // Fallback to UMD version
        console.log("üì¶ Attempting to load UMD module...");
        const script = document.createElement("script");
        script.src = "./dist/terminal-session.umd.js";
        script.onload = () => {
          console.log("‚úÖ UMD module loaded successfully");
          console.log(
            "Available globals:",
            Object.keys(window).filter((key) => key.includes("Terminal"))
          );
        };
        script.onerror = (err) => {
          console.error("‚ùå UMD module also failed to load:", err);
          console.log(
            "üîß Please check if dist/terminal-session.umd.js exists and is accessible"
          );
        };
        document.head.appendChild(script);
      }

      // Basic terminal session
      const basicSession = [
        { type: "command", content: "git status", delay: 500 },
        {
          type: "output",
          content:
            "On branch main\nYour branch is up to date with 'origin/main'.\n\nChanges not staged for commit:",
          delay: 800,
        },
        {
          type: "warning",
          content:
            "  modified:   src/components/Header.jsx\n  modified:   src/styles/main.css",
          delay: 600,
        },
        { type: "command", content: "git add .", delay: 1000 },
        {
          type: "command",
          content: 'git commit -m "Update header styling"',
          delay: 800,
        },
        {
          type: "output",
          content: "[main 3a4f5b6] Update header styling",
          delay: 500,
        },
        {
          type: "success",
          content: " 2 files changed, 24 insertions(+), 8 deletions(-)",
          delay: 400,
        },
        { type: "command", content: "git push origin main", delay: 1000 },
        {
          type: "output",
          content:
            "Enumerating objects: 7, done.\nCounting objects: 100% (7/7), done.\nDelta compression using up to 8 threads\nCompressing objects: 100% (4/4), done.\nWriting objects: 100% (4/4), 512 bytes | 512.00 KiB/s, done.",
          delay: 1200,
        },
        {
          type: "success",
          content:
            "To github.com:user/repo.git\n   2b3c4d5..3a4f5b6  main -> main",
          delay: 500,
        },
      ];

      // Set sessions but don't autoplay all at once to prevent performance issues
      document.getElementById("basic-terminal").session = basicSession;
      document.getElementById("basic-terminal").autoplay = false;

      document.getElementById("light-terminal").session = basicSession;
      document.getElementById("light-terminal").autoplay = false;

      // Toolbar demo terminals
      document.getElementById("toolbar-no-window").session = basicSession;
      document.getElementById("toolbar-no-controls").session = basicSession;
      document.getElementById("toolbar-play-only").session = basicSession;
      document.getElementById("toolbar-no-header").session = basicSession;

      // Tabbed terminal setup - Enhanced for testing tab closing
      const tabbedTerminal = document.getElementById("tabbed-terminal");
      tabbedTerminal.tabs = [
        {
          id: "frontend-tab",
          title: "Frontend Server",
          icon: "üöÄ",
          session: [
            { type: "command", content: "npm run dev", delay: 500 },
            { type: "output", content: "> vite dev --port 3000", delay: 600 },
            {
              type: "info",
              content: "üî• Vite v5.0.0 dev server running at:",
              delay: 800,
            },
            {
              type: "success",
              content: "  ‚ûú  Local:   http://localhost:3000/",
              delay: 600,
            },
            {
              type: "success",
              content: "  ‚ûú  Network: http://192.168.1.100:3000/",
              delay: 400,
            },
            { type: "output", content: "  ready in 423ms", delay: 300 },
            {
              type: "info",
              content: "[HMR] Hot Module Replacement enabled",
              delay: 700,
            },
          ],
          closable: true,
          status: "success",
        },
        {
          id: "api-tab",
          title: "API Server",
          icon: "‚ö°",
          session: [
            { type: "command", content: "node server.js", delay: 500 },
            {
              type: "output",
              content: "üåü Starting Express API server...",
              delay: 600,
            },
            {
              type: "info",
              content: "üì° Connecting to MongoDB...",
              delay: 800,
            },
            {
              type: "success",
              content: "‚úÖ Database connected successfully",
              delay: 900,
            },
            {
              type: "success",
              content: "üöÄ API server listening on port 8080",
              delay: 600,
            },
            {
              type: "output",
              content: "üìä Health check endpoint: http://localhost:8080/health",
              delay: 500,
            },
          ],
          closable: true,
          badge: "API",
          status: "running",
        },
        {
          id: "testing-tab",
          title: "Test Suite",
          icon: "üß™",
          session: [
            { type: "command", content: "npm run test:watch", delay: 500 },
            {
              type: "output",
              content: "> jest --watch --coverage",
              delay: 700,
            },
            {
              type: "info",
              content: "üîç Running tests in watch mode...",
              delay: 800,
            },
            {
              type: "success",
              content: "‚úÖ Components ‚Ä∫ Button.test.js (5 tests passed)",
              delay: 600,
            },
            {
              type: "success",
              content: "‚úÖ Utils ‚Ä∫ helpers.test.js (8 tests passed)",
              delay: 500,
            },
            {
              type: "error",
              content: "‚ùå API ‚Ä∫ auth.test.js (2 tests failed)",
              delay: 600,
            },
            {
              type: "warning",
              content: "‚ö†Ô∏è  Coverage: 87.5% (target: 90%)",
              delay: 400,
            },
            {
              type: "info",
              content: "üëÄ Watching for file changes...",
              delay: 500,
            },
          ],
          closable: true,
          status: "error",
        },
        {
          id: "database-tab",
          title: "Database",
          icon: "üóÑÔ∏è",
          session: [
            {
              type: "command",
              content: "docker-compose up postgres",
              delay: 500,
            },
            {
              type: "output",
              content: "üê≥ Starting PostgreSQL container...",
              delay: 700,
            },
            {
              type: "info",
              content: "üì¶ Pulling postgres:15-alpine image...",
              delay: 900,
            },
            {
              type: "success",
              content: "‚úÖ Container postgres_db started",
              delay: 800,
            },
            {
              type: "output",
              content: "üîå Database ready to accept connections",
              delay: 600,
            },
            {
              type: "success",
              content: "üéØ Connection: postgresql://localhost:5432/myapp",
              delay: 400,
            },
          ],
          closable: true,
          status: "success",
        },
        {
          id: "monitoring-tab",
          title: "Monitoring",
          icon: "üìä",
          session: [
            {
              type: "command",
              content: "npm run monitor",
              delay: 500,
            },
            {
              type: "output",
              content: "üìà Starting performance monitor...",
              delay: 700,
            },
            {
              type: "info",
              content: "üîç CPU Usage: 12.5%",
              delay: 600,
            },
            {
              type: "info",
              content: "üíæ Memory Usage: 256MB / 8GB",
              delay: 500,
            },
            {
              type: "warning",
              content: "‚ö†Ô∏è  API Response Time: 245ms (high)",
              delay: 700,
            },
            {
              type: "success",
              content: "‚úÖ All services healthy",
              delay: 400,
            },
          ],
          closable: true,
          status: "idle",
        },
      ];

      // Minimal tabbed terminal
      const minimalTabbed = document.getElementById("tabbed-minimal");
      if (minimalTabbed) {
        minimalTabbed.tabs = [
          {
            id: "minimal-1",
            title: "Process 1",
            icon: "1Ô∏è‚É£",
            session: [
              { type: "command", content: "docker-compose up", delay: 500 },
              {
                type: "output",
                content: 'Creating network "app_default"',
                delay: 600,
              },
              {
                type: "output",
                content: 'Creating volume "app_data"',
                delay: 700,
              },
              {
                type: "info",
                content: "Starting database container...",
                delay: 800,
              },
              {
                type: "success",
                content: "Database is ready for connections",
                delay: 1000,
              },
              {
                type: "info",
                content: "Starting application container...",
                delay: 800,
              },
              {
                type: "success",
                content: "Application started on port 3000",
                delay: 900,
              },
            ],
            closable: true,
          },
          {
            id: "minimal-2",
            title: "Process 2",
            icon: "2Ô∏è‚É£",
            session: [
              { type: "command", content: "npm run dev", delay: 500 },
              {
                type: "output",
                content: "Starting development server...",
                delay: 700,
              },
              {
                type: "info",
                content: "Vite v5.0.0 dev server running at:",
                delay: 600,
              },
              { type: "success", content: "http://localhost:5173", delay: 400 },
              { type: "output", content: "ready in 523ms", delay: 500 },
            ],
            closable: true,
          },
          {
            id: "minimal-3",
            title: "Process 3",
            icon: "3Ô∏è‚É£",
            session: [
              { type: "command", content: "npm run test:watch", delay: 500 },
              {
                type: "output",
                content: "Watching for file changes...",
                delay: 800,
              },
              { type: "success", content: "‚úì 15 tests passed", delay: 1200 },
              {
                type: "info",
                content: "Waiting for file changes...",
                delay: 600,
              },
            ],
            closable: false,
          },
        ];
      }

      // Minimal no-toolbar terminal
      const minimalNoToolbar = document.getElementById("minimal-no-toolbar");
      if (minimalNoToolbar) {
        minimalNoToolbar.session = [
          {
            type: "command",
            content: "curl -X GET https://api.example.com/data",
            delay: 500,
          },
          {
            type: "output",
            content: '{"status": "success", "data": {',
            delay: 600,
          },
          { type: "output", content: '  "users": 1247,', delay: 400 },
          { type: "output", content: '  "active": true,', delay: 400 },
          {
            type: "output",
            content: '  "timestamp": "2024-01-15T10:30:00Z"',
            delay: 400,
          },
          { type: "output", content: "}}", delay: 300 },
          {
            type: "command",
            content: 'echo "API call successful"',
            delay: 800,
          },
          { type: "success", content: "API call successful", delay: 500 },
        ];
      }

      // Custom colors terminal
      const customTerminal = document.getElementById("custom-terminal");
      customTerminal.session = basicSession;
      customTerminal.colors = {
        background: "#1e1e2e",
        foreground: "#cdd6f4",
        prompt: "#89b4fa",
        command: "#94e2d5",
        success: "#a6e3a1",
        warning: "#f9e2af",
        error: "#f38ba8",
      };
      customTerminal.autoplay = false;

      // Only autoplay the first visible terminal to prevent performance issues
      // Use Intersection Observer to play terminals when they come into view
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              const terminal = entry.target;
              if (
                terminal.session &&
                terminal.session.length > 0 &&
                !terminal.hasPlayed
              ) {
                terminal.hasPlayed = true;
                terminal.autoplay = true;
              }
            }
          });
        },
        { threshold: 0.5 }
      );

      // Observe all terminals except the interactive one
      observer.observe(document.getElementById("basic-terminal"));
      observer.observe(document.getElementById("light-terminal"));
      observer.observe(document.getElementById("custom-terminal"));
      observer.observe(document.getElementById("toolbar-no-window"));
      observer.observe(document.getElementById("toolbar-play-only"));
      observer.observe(document.getElementById("toolbar-no-header"));
      if (document.getElementById("minimal-no-toolbar")) {
        observer.observe(document.getElementById("minimal-no-toolbar"));
      }

      // Rich content terminal - API Validator Table Example
      const richContentTerminal = document.getElementById(
        "rich-content-terminal"
      );
      richContentTerminal.session = [
        {
          type: "command",
          content: [{ text: " api-metadata-validator ./petstore.v3.yaml" }],
          delay: 500,
        },
        {
          type: "output",
          content: [
            {
              text: "API Metadata Validator v3.22.0",
              backgroundColor: "#bfbfbf",
              color: "#000000",
              fontWeight: "bold",
              display: "block",
              marginTop: "1.5em",
              marginBottom: "1.5em",
            },
          ],
          delay: 600,
          marginTop: "1em",
          marginBottom: "1em",
        },
        {
          type: "output",
          content: [
            {
              text: "/Users/Validator/api-metadata-validator/petstore.v3.yaml",
              textDecoration: "underline",
            },
            { text: " [compliance-level: " },
            {
              text: "sap:core:v1",
              fontWeight: "bold",
              textDecoration: "underline",
              url: "https://www.google.com/search?q=SAP+core+v1+compliance+level",
              target: "_blank",
            },
            { text: ", overrides-detected: " },
            { text: "No", color: "#cd3131", fontWeight: "bold" },
            { text: "]" },
          ],
          delay: 400,
        },
        {
          type: "output",
          content: [
            // Full API validator table output
            // Row 1: First error
            {
              text: "1:1",
              isTableRow: true,
              tableColumn: "position",
              columnGap: "36px",
              rowGap: "6px",
            },
            { text: "error", color: "#cd3131", tableColumn: "type" },
            {
              text: "sap-oas-short-text",
              textDecoration: "underline",
              tableColumn: "rule",
              url: "https://www.google.com/search?q=SAP+OAS+sap-oas-short-text+specification",
              target: "_blank",
            },
            {
              text: "A short description in the `x-sap-shortText` field is missing.",
              tableColumn: "message",
            },

            // Row 2: Warning with context line following
            {
              text: "4:10",
              isTableRow: true,
              tableColumn: "position",
              columnGap: "36px",
              rowGap: "4px",
            },
            { text: "warning", color: "#949800", tableColumn: "type" },
            {
              text: "sap-oas-title-chars",
              textDecoration: "underline",
              tableColumn: "rule",
              url: "https://www.google.com/search?q=SAP+OAS+sap-oas-title-chars+specification",
              target: "_blank",
            },
            {
              text: "The API name should use the allowed charset and not contain version number, and operation words like create, read, delete, and update.",
              tableColumn: "message",
            },

            // Context line for warning above
            {
              text: "",
              isTableRow: true,
              tableColumn: "position",
              columnGap: "36px",
              rowGap: "4px",
            },
            { text: "", tableColumn: "type" },
            { text: "", tableColumn: "rule" },
            {
              text: "                        info.title",
              tableColumn: "message",
              color: "#666",
            },

            // Row 3: Information with context line following
            {
              text: "10:9",
              isTableRow: true,
              tableColumn: "position",
              columnGap: "36px",
              rowGap: "4px",
            },
            { text: "information", color: "#0451a5", tableColumn: "type" },
            {
              text: "sap-oas3-sandbox",
              textDecoration: "underline",
              tableColumn: "rule",
              url: "https://www.google.com/search?q=SAP+OAS+sap-oas3-sandbox+specification",
              target: "_blank",
            },
            {
              text: "The sandbox definition is missing.",
              tableColumn: "message",
            },

            // Context line for information above
            {
              text: "",
              isTableRow: true,
              tableColumn: "position",
              columnGap: "36px",
              rowGap: "4px",
            },
            { text: "", tableColumn: "type" },
            { text: "", tableColumn: "rule" },
            {
              text: "                        servers",
              tableColumn: "message",
              color: "#666",
            },

            // Row 4: Error with context line following
            {
              text: "14:9",
              isTableRow: true,
              tableColumn: "position",
              columnGap: "36px",
              rowGap: "4px",
            },
            { text: "error", color: "#cd3131", tableColumn: "type" },
            {
              text: "sap-oas-operation-summary",
              textDecoration: "underline",
              tableColumn: "rule",
              url: "https://www.google.com/search?q=SAP+OAS+sap-oas-operation-summary+specification",
              target: "_blank",
            },
            {
              text: "A short summary of the operation must appear in each operation's line",
              tableColumn: "message",
            },

            // Context line for error above
            {
              text: "",
              isTableRow: true,
              tableColumn: "position",
              columnGap: "36px",
              rowGap: "4px",
            },
            { text: "", tableColumn: "type" },
            { text: "", tableColumn: "rule" },
            {
              text: "                        paths./pets.get",
              tableColumn: "message",
              color: "#666",
            },
          ],
          delay: 500,
        },
        {
          type: "error",
          content: [
            {
              text: "‚úñ 4 problems (2 errors, 1 warning, 1 info)",
              color: "#cd3131",
              fontWeight: "bold",
            },
          ],
          delay: 800,
        },
      ];

      // Interactive terminal
      const interactiveTerminal = document.getElementById(
        "interactive-terminal"
      );
      interactiveTerminal.session = [
        {
          type: "info",
          content: "Welcome to the interactive terminal demo!",
          delay: 500,
        },
        { type: "command", content: 'echo "Hello, World!"', delay: 800 },
        { type: "output", content: "Hello, World!", delay: 500 },
      ];

      // Helper function to reset terminal to single-session mode
      function resetToSingleMode() {
        interactiveTerminal.tabs = [];
        interactiveTerminal.showTabs = false;
        interactiveTerminal.allowTabClose = false;
      }

      // Interactive functions
      window.addCustomSession = function () {
        resetToSingleMode();
        interactiveTerminal.session = [
          { type: "command", content: "npm run build", delay: 500 },
          {
            type: "output",
            content: "> svelte-terminal@1.0.0 build\n> vite build",
            delay: 800,
          },
          {
            type: "info",
            content: "vite v5.0.0 building for production...",
            delay: 600,
          },
          { type: "output", content: "‚úì 42 modules transformed.", delay: 1000 },
          {
            type: "success",
            content:
              "dist/index.html        0.45 kB\ndist/assets/index.css  1.23 kB\ndist/assets/index.js   8.76 kB",
            delay: 800,
          },
          { type: "success", content: "‚úì built in 1.23s", delay: 500 },
        ];
        interactiveTerminal.autoplay = true;
      };

      window.toggleTheme = function () {
        const current = interactiveTerminal.theme;
        interactiveTerminal.theme = current === "dark" ? "light" : "dark";
      };

      window.changeSpeed = function () {
        const speeds = [0.5, 1, 1.5, 2];
        const current = interactiveTerminal.playbackSpeed || 1;
        const currentIndex = speeds.indexOf(current);
        const nextIndex = (currentIndex + 1) % speeds.length;
        interactiveTerminal.playbackSpeed = speeds[nextIndex];
        alert(`Playback speed set to ${speeds[nextIndex]}x`);
      };

      window.showErrorExample = function () {
        resetToSingleMode();
        interactiveTerminal.session = [
          { type: "command", content: "npm test", delay: 500 },
          {
            type: "output",
            content: "> svelte-terminal@1.0.0 test\n> vitest",
            delay: 800,
          },
          {
            type: "error",
            content: "FAIL  src/components/Terminal.test.js",
            delay: 600,
          },
          {
            type: "error",
            content:
              "  ‚óè Terminal ‚Ä∫ should render without errors\n\n    TypeError: Cannot read property 'theme' of undefined",
            delay: 800,
          },
          {
            type: "output",
            content:
              "\nTest Suites: 1 failed, 1 total\nTests:       1 failed, 1 total",
            delay: 600,
          },
          {
            type: "error",
            content: "npm ERR! Test failed. See above for more details.",
            delay: 500,
          },
        ];
        interactiveTerminal.autoplay = true;
      };

      window.showRichContentExample = function () {
        resetToSingleMode();
        interactiveTerminal.session = [
          {
            type: "command",
            content: [
              { text: "git", color: "#569cd6", fontWeight: "bold" },
              { text: " log ", color: "#ffffff" },
              { text: "--oneline", color: "#ce9178" },
            ],
            delay: 500,
          },
          {
            type: "output",
            content: [
              { text: "a1b2c3d", color: "#dcdcaa", fontWeight: "bold" },
              { text: " feat: add rich text support (", color: "#ffffff" },
              { text: "HEAD -> ", color: "#569cd6" },
              { text: "main", color: "#4ec9b0", fontWeight: "bold" },
              { text: ")", color: "#ffffff" },
            ],
            delay: 600,
          },
          {
            type: "output",
            content: [
              { text: "e4f5g6h", color: "#dcdcaa", fontWeight: "bold" },
              { text: " fix: typing animation issues", color: "#ffffff" },
            ],
            delay: 400,
          },
          {
            type: "output",
            content: [
              { text: "i7j8k9l", color: "#dcdcaa", fontWeight: "bold" },
              { text: " docs: update examples", color: "#ffffff" },
            ],
            delay: 400,
          },
        ];
        interactiveTerminal.autoplay = true;
      };

      window.showTableExample = function () {
        resetToSingleMode();
        interactiveTerminal.session = [
          {
            type: "command",
            content: "npm audit --audit-level=high",
            delay: 500,
          },
          {
            type: "output",
            content: [
              {
                text: "# npm audit report",
                color: "#569cd6",
                fontWeight: "bold",
                display: "block",
                marginBottom: "1em",
              },
            ],
            delay: 400,
          },
          {
            type: "output",
            content: [
              {
                text: "Package",
                isTableRow: true,
                fontWeight: "bold",
                tableColumn: "position",
                columnGap: "20px",
                rowGap: "6px",
              },
              { text: "Severity", fontWeight: "bold", tableColumn: "type" },
              { text: "Issue", fontWeight: "bold", tableColumn: "rule" },
              { text: "Path", fontWeight: "bold", tableColumn: "message" },
            ],
            delay: 300,
          },
          {
            type: "output",
            content: [
              {
                text: "axios",
                isTableRow: true,
                tableColumn: "position",
                columnGap: "20px",
                rowGap: "6px",
              },
              {
                text: "High",
                color: "#cd3131",
                fontWeight: "bold",
                tableColumn: "type",
              },
              {
                text: "Prototype Pollution",
                color: "#ff6b6b",
                tableColumn: "rule",
              },
              {
                text: "node_modules/axios",
                color: "#666",
                tableColumn: "message",
              },
            ],
            delay: 400,
          },
          {
            type: "output",
            content: [
              {
                text: "lodash",
                isTableRow: true,
                tableColumn: "position",
                columnGap: "20px",
              },
              {
                text: "Critical",
                color: "#dc143c",
                fontWeight: "bold",
                tableColumn: "type",
              },
              {
                text: "Command Injection",
                color: "#ff4757",
                tableColumn: "rule",
              },
              {
                text: "node_modules/lodash",
                color: "#666",
                tableColumn: "message",
              },
            ],
            delay: 400,
          },
          {
            type: "output",
            content: [
              {
                text: "express",
                isTableRow: true,
                tableColumn: "position",
                columnGap: "20px",
              },
              {
                text: "Moderate",
                color: "#f39c12",
                fontWeight: "bold",
                tableColumn: "type",
              },
              { text: "Open Redirect", color: "#ffa502", tableColumn: "rule" },
              {
                text: "node_modules/express",
                color: "#666",
                tableColumn: "message",
              },
            ],
            delay: 400,
          },
          {
            type: "output",
            content: [
              {
                text: "react-dom",
                isTableRow: true,
                tableColumn: "position",
                columnGap: "20px",
              },
              {
                text: "High",
                color: "#cd3131",
                fontWeight: "bold",
                tableColumn: "type",
              },
              {
                text: "XSS Vulnerability",
                color: "#ff6b6b",
                tableColumn: "rule",
              },
              {
                text: "node_modules/react-dom",
                color: "#666",
                tableColumn: "message",
              },
            ],
            delay: 400,
          },
          {
            type: "output",
            content: [
              {
                text: "minimist",
                isTableRow: true,
                tableColumn: "position",
                columnGap: "20px",
              },
              { text: "Low", color: "#27ae60", tableColumn: "type" },
              {
                text: "Prototype Pollution",
                color: "#2ed573",
                tableColumn: "rule",
              },
              {
                text: "node_modules/minimist",
                color: "#666",
                tableColumn: "message",
              },
            ],
            delay: 400,
          },
          {
            type: "warning",
            content: [
              {
                text: "\nFound 5 vulnerabilities (1 low, 1 moderate, 2 high, 1 critical)",
                color: "#f39c12",
                fontWeight: "bold",
                display: "block",
                marginTop: "1em",
              },
            ],
            delay: 600,
          },
          {
            type: "info",
            content: [
              {
                text: "Run `npm audit fix` to fix them, or `npm audit` for details.",
                color: "#3498db",
              },
            ],
            delay: 400,
          },
        ];
        interactiveTerminal.autoplay = true;
      };

      // New test functions for tab closing and theme toggle
      window.testTabClosing = function () {
        // Set up tabs for testing tab closing
        interactiveTerminal.tabs = [
          {
            id: "tab-test-1",
            title: "Tab 1 - Build",
            icon: "üî®",
            session: [
              { type: "command", content: "npm run build", delay: 500 },
              { type: "output", content: "> Building project...", delay: 600 },
              {
                type: "success",
                content: "‚úÖ Build completed successfully!",
                delay: 800,
              },
            ],
            closable: true,
          },
          {
            id: "tab-test-2",
            title: "Tab 2 - Test",
            icon: "üß™",
            session: [
              { type: "command", content: "npm test", delay: 500 },
              {
                type: "output",
                content: "> Running test suite...",
                delay: 700,
              },
              {
                type: "success",
                content: "‚úÖ All 25 tests passed!",
                delay: 900,
              },
            ],
            closable: true,
          },
          {
            id: "tab-test-3",
            title: "Tab 3 - Deploy",
            icon: "üöÄ",
            session: [
              { type: "command", content: "npm run deploy", delay: 500 },
              {
                type: "output",
                content: "> Deploying to production...",
                delay: 800,
              },
              {
                type: "success",
                content: "üéâ Deployed successfully!",
                delay: 700,
              },
            ],
            closable: true,
          },
        ];
        interactiveTerminal.showTabs = true;
        interactiveTerminal.allowTabClose = true;
        alert(
          "‚úÖ Tabs loaded! Now try:\n1. Click between tabs to see different content\n2. Close the active tab by clicking √ó\n3. Notice how content switches immediately!"
        );
      };

      window.testThemeToggle = function () {
        interactiveTerminal.showThemeToggle = true;
        alert(
          "‚úÖ Theme toggle enabled! Look for the ‚òÄ/üåô button in the terminal header and click it to test instant theme switching."
        );
      };
    </script>
  </body>
</html>
